!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs/Observable"),require("rxjs/add/operator/map"),require("rxjs/add/operator/mergeMap"),require("rxjs/add/operator/expand"),require("rxjs/add/operator/last"),require("rxjs/add/observable/of"),require("rxjs/add/observable/empty"),require("rxjs/add/observable/from")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common/http","rxjs/Observable","rxjs/add/operator/map","rxjs/add/operator/mergeMap","rxjs/add/operator/expand","rxjs/add/operator/last","rxjs/add/observable/of","rxjs/add/observable/empty","rxjs/add/observable/from"],r):r((e.ng=e.ng||{},e.ng.springhal=e.ng.springhal||{}),e.ng.core,e.ng.common.http,e.Rx)}(this,function(e,r,t,n){"use strict";var o=function(){function e(){}return e.prototype.build=function(e,r,t){return this.parse(e,r,t)},e.prototype.parse=function(e,r,t,n){if(r._embedded){n=n||this.findRelationName(r);var o=r._embedded[n];if(o&&o instanceof Array){for(var a=new Array,i=0,s=o;i<s.length;i++){var u=s[i];a.push(this.buildObject(e,u,t))}return a}console.error("Can't parse array result: ",r._embedded,n)}return this.buildObject(e,r,t)},e.prototype.findRelationName=function(e){if(!e._embedded)return"";for(var r in e._embedded)return r;return""},e.prototype.buildObject=function(r,t,n){var o=new r,a=o[e.PROTOTYPE_IDENT_HAL_PROPERTIES],i=o[e.PROTOTYPE_IDENT_HAL_LINKS],s=o[e.PROTOTYPE_IDENT_HAL_RESOLVES];return o=this.assignProperties(o,a,t),o=this.assignLinks(o,i,t,n),o=this.assignContent(o,t.content),o=this.assignResolves(o,s,n)},e.prototype.assignProperties=function(e,r,t){if(!r)return e;for(var n=0,o=r;n<o.length;n++){var a=o[n];t[a.relationName]&&Object.defineProperty(e,a.propertyKey,{value:t[a.relationName]})}return e},e.prototype.assignResolves=function(e,r,t){if(!r)return e;for(var n=0,o=r;n<o.length;n++)!function(r){t.resolveAsyncPath(e,r.propertyPath).subscribe(function(t){return Object.defineProperty(e,r.propertyKey,{value:t})})}(o[n]);return e},e.prototype.assignContent=function(e,r){if(!r)return e;for(var t in r)Object.defineProperty(e,t,{value:r[t]});return e},e.prototype.assignLinks=function(e,r,t,n){if(!r)return e;var o=t._links;if(!o)return e;for(var a=0,i=r;a<i.length;a++){var s=i[a];if(o[s.relationName]){var u=o[s.relationName];Object.defineProperty(e,s.propertyKey,{value:n.get(u.href,s.clazz)})}}return e},e.PROTOTYPE_IDENT_HAL_PROPERTIES="halProperties",e.PROTOTYPE_IDENT_HAL_LINKS="halLinks",e.PROTOTYPE_IDENT_HAL_RESOLVES="halResolves",e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[]},e}(),a=function(){return function(){}}(),i=function(){function e(e,r){this._httpClient=e,this._modelBuilder=r}return e.prototype.get=function(e,r){var t=this;return this._httpClient.get(e).map(function(e){return t._modelBuilder.build(r,e,t)})},e.prototype.resolveAsyncPath=function(e,r){return this.resolveAsync(e,r.split("."))},e.prototype.resolveAsync=function(e,r,t){var o=this;return void 0===t&&(t=!1),r=r.reverse(),n.Observable.of(e).expand(function(e){if(0==r.length)return n.Observable.empty();var i=r.pop(),s=void 0;return i&&(s=e[i]),e instanceof a&&s instanceof n.Observable?!0===t?s.flatMap(function(e){if(e instanceof Array){var t=r;return n.Observable.from(e).flatMap(function(e){return o.resolveAsync(e,t)})}return n.Observable.of(e)}):s:n.Observable.of(s)}).last()},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:t.HttpClient},{type:o}]},e}(),s=function(){function e(){}return e.decorators=[{type:r.NgModule,args:[{imports:[t.HttpClientModule],exports:[],declarations:[],providers:[i,o]}]}],e.ctorParameters=function(){return[]},e}();e.SpringHalModule=s,e.HalRestService=i,e.HalModel=a,e.HalLink=function(e,r){return function(t,n){t[o.PROTOTYPE_IDENT_HAL_LINKS]||(t[o.PROTOTYPE_IDENT_HAL_LINKS]=new Array),t[o.PROTOTYPE_IDENT_HAL_LINKS].push({clazz:e,relationName:r||n,propertyKey:n})}},e.HalProperty=function(e){return function(r,t){r[o.PROTOTYPE_IDENT_HAL_PROPERTIES]||(r[o.PROTOTYPE_IDENT_HAL_PROPERTIES]=new Array),r[o.PROTOTYPE_IDENT_HAL_PROPERTIES].push({relationName:e||t,propertyKey:t})}},e.HalResolve=function(e){return function(r,t){r[o.PROTOTYPE_IDENT_HAL_RESOLVES]||(r[o.PROTOTYPE_IDENT_HAL_RESOLVES]=new Array),r[o.PROTOTYPE_IDENT_HAL_RESOLVES].push({propertyKey:t,propertyPath:e})}},Object.defineProperty(e,"__esModule",{value:!0})});